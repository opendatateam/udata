{% set resource_format = resource.format|trim|lower or 'data' %}
<div id="resource-{{resource.id}}" class="list-group-item"
    itemscope="itemscope" itemtype="http://schema.org/DataDownload"
    data-checkurl="{{ url_for('api.checkurl') }}">
    <div class="format-label pull-left ellipsis-dot">
        <span data-format="{{ resource_format }}">
            {{ resource_format }}
        </span>
    </div>
    <h4 class="list-group-item-heading ellipsis">
        <a itemprop="url" href="{{resource.url}}">
            <span itemprop="name">{{ resource.title or _('Nameless resource') }}</span>
            <meta itemprop="contentUrl" content="{{resource.url}}" />
            {% if resource.description %}
            <meta itemprop="description" content="{{ resource.description|markdown|forceescape }}" />
            {% endif %}
            <meta itemprop="encodingFormat" content="{{resource.format or ''}}" />
            <meta itemprop="dateCreated" content="{{resource.created_at|isoformat}}" />
            <meta itemprop="dateModified" content="{{resource.modified|isoformat}}" />
            <meta itemprop="datePublished" content="{{resource.published|dateformat('long')}}" />
            <meta itemprop="contentSize" content="{{resource.filesize or ''}}" />
            <meta itemprop="mimetype" content="{{resource.mime or ''}}" />
            <meta itemprop="downloads" content="{{resource.metrics.views or ''}}" />
            {% if resource.checksum %}
            <meta itemprop="checksum" content="{{resource.checksum.value}}" />
            <meta itemprop="checksumType" content="{{resource.checksum.type or 'sha1'}}" />
            {% endif %}
        </a>
    </h4>
    <p class="list-group-item-text ellipsis">
        {{ _('Last modified on %(date)s',
            date=resource.modified|dateformat('full'),
        ) }}
    </p>
    {% if resource.owner %}
    {{ resource.owner|avatar(52, 'resource-owner') }}
    {% endif %}

    {% if can_edit_resource(resource, dataset) %}
        {% if resource.from_community %}
            {% if resource.owner %}
                {% set edit_url = url_for('admin.index', path='user/{id}/'.format(id=resource.owner.id), **{'community_id': resource.id}) %}
            {% else %}
                {% set edit_url = url_for('admin.index', path='organization/{id}/'.format(id=resource.organization.id), **{'community_id': resource.id}) %}
            {% endif %}
        {% else %}
            {% set edit_url = url_for('admin.index', path='dataset/{id}/'.format(id=dataset.id), **{'resource_id': resource.id}) %}
        {% endif %}
        <div class="btn-group btn-group-xs tools">
            <a class="btn btn-default" rel="tooltip" title="{{ _('Edit') }}"
                href="{{Â edit_url }}">
                <span class="glyphicon glyphicon-edit"></span>
            </a>
        </div>
    {% endif %}

</div>
